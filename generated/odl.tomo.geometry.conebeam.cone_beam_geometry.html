

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cone_beam_geometry &mdash; odl 1.0.0.dev0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="helical_geometry" href="odl.tomo.geometry.conebeam.helical_geometry.html" />
    <link rel="prev" title="FanFlatGeometry.src_position" href="odl.tomo.geometry.conebeam.FanFlatGeometry.src_position.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> odl
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with ODL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/guide.html">User’s guide – selected topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/math.html">Mathematical Background</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer zone</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/dev.html">Contributing to ODL</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful facts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../odl.html">odl</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../odl.contrib.html">contrib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.deform.html">deform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.diagnostics.html">diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.discr.html">discr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.operator.html">operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.phantom.html">phantom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.set.html">set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.solvers.html">solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.space.html">space</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../odl.tomo.html">tomo</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../odl.tomo.analytic.html">analytic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../odl.tomo.backends.html">backends</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../odl.tomo.geometry.html">geometry</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../odl.tomo.geometry.conebeam.html">conebeam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.tomo.geometry.detector.html">detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.tomo.geometry.geometry.html">geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.tomo.geometry.parallel.html">parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.tomo.geometry.spect.html">spect</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../odl.tomo.operators.html">operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../odl.tomo.util.html">util</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../odl.trafos.html">trafos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.ufunc_ops.html">ufunc_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.util.html">util</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">odl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../odl.html">odl</a> &raquo;</li>
        
          <li><a href="../odl.tomo.html">tomo</a> &raquo;</li>
        
          <li><a href="../odl.tomo.geometry.html">geometry</a> &raquo;</li>
        
          <li><a href="../odl.tomo.geometry.conebeam.html">conebeam</a> &raquo;</li>
        
      <li>cone_beam_geometry</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/odl.tomo.geometry.conebeam.cone_beam_geometry.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cone-beam-geometry">
<h1>cone_beam_geometry<a class="headerlink" href="#cone-beam-geometry" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="odl.tomo.geometry.conebeam.cone_beam_geometry">
<code class="descclassname">odl.tomo.geometry.conebeam.</code><code class="descname">cone_beam_geometry</code><span class="sig-paren">(</span><em>space</em>, <em>src_radius</em>, <em>det_radius</em>, <em>num_angles=None</em>, <em>short_scan=False</em>, <em>det_shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odl/tomo/geometry/conebeam.html#cone_beam_geometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#odl.tomo.geometry.conebeam.cone_beam_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a default fan or cone beam geometry from <code class="docutils literal notranslate"><span class="pre">space</span></code>.</p>
<p>This function is intended for simple test cases where users do not
need the full flexibility of the geometries, but simply wants a
geometry that works.</p>
<p>The geometry returned by this function has equidistant angles
that lie (strictly) between 0 and either <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi</span></code> (full scan)
or <code class="docutils literal notranslate"><span class="pre">pi</span> <span class="pre">+</span> <span class="pre">fan_angle</span></code> (short scan).
The detector is centered around 0, and its size is chosen such that
the whole <code class="docutils literal notranslate"><span class="pre">space</span></code> is covered with lines.</p>
<p>The number of angles and detector elements is chosen such that
the resulting sinogram is fully sampled according to the
Nyquist criterion, which in general results in a very large number of
samples. In particular, a <code class="docutils literal notranslate"><span class="pre">space</span></code> that is not centered at the origin
can result in very large detectors since the latter is always
origin-centered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt>space <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="odl.discr.lp_discr.DiscreteLp.html#odl.discr.lp_discr.DiscreteLp" title="odl.discr.lp_discr.DiscreteLp"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DiscreteLp</span></code></a></span></dt>
<dd><p class="first last">Reconstruction space, the space of the volumetric data to be
projected. Must be 2- or 3-dimensional.</p>
</dd>
<dt>src_radius <span class="classifier-delimiter">:</span> <span class="classifier">nonnegative float</span></dt>
<dd><p class="first last">Radius of the source circle. Must be larger than the radius of
the smallest vertical cylinder containing <code class="docutils literal notranslate"><span class="pre">space.domain</span></code>,
i.e., the source must be outside the volume for all rotations.</p>
</dd>
<dt>det_radius <span class="classifier-delimiter">:</span> <span class="classifier">nonnegative float</span></dt>
<dd><p class="first last">Radius of the detector circle.</p>
</dd>
<dt>short_scan <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Use the minimum required angular range <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">pi</span> <span class="pre">+</span> <span class="pre">fan_angle]</span></code>.
For <code class="docutils literal notranslate"><span class="pre">True</span></code>, the <a class="reference internal" href="odl.tomo.analytic.filtered_back_projection.parker_weighting.html#odl.tomo.analytic.filtered_back_projection.parker_weighting" title="odl.tomo.analytic.filtered_back_projection.parker_weighting"><code class="xref any py py-func docutils literal notranslate"><span class="pre">parker_weighting</span></code></a> should be used in FBP.
By default, the range <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi]</span></code> is used.</p>
</dd>
<dt>num_angles <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of angles.
Default: Enough to fully sample the data, see Notes.</p>
</dd>
<dt>det_shape <span class="classifier-delimiter">:</span> <span class="classifier">int or sequence of ints, optional</span></dt>
<dd><p class="first last">Number of detector pixels.
Default: Enough to fully sample the data, see Notes.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt>geometry <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="odl.tomo.geometry.geometry.DivergentBeamGeometry.html#odl.tomo.geometry.geometry.DivergentBeamGeometry" title="odl.tomo.geometry.geometry.DivergentBeamGeometry"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DivergentBeamGeometry</span></code></a></span></dt>
<dd><p class="first">Projection geometry with equidistant angles and zero-centered
detector as determined by sampling criteria.</p>
<blockquote class="last">
<div><ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">space</span></code> is 2D, the result is a <a class="reference internal" href="odl.tomo.geometry.conebeam.FanFlatGeometry.html#odl.tomo.geometry.conebeam.FanFlatGeometry" title="odl.tomo.geometry.conebeam.FanFlatGeometry"><code class="xref any py py-class docutils literal notranslate"><span class="pre">FanFlatGeometry</span></code></a>.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">space</span></code> is 3D, the result is a <a class="reference internal" href="odl.tomo.geometry.conebeam.ConeFlatGeometry.html#odl.tomo.geometry.conebeam.ConeFlatGeometry" title="odl.tomo.geometry.conebeam.ConeFlatGeometry"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ConeFlatGeometry</span></code></a>.</li>
</ul>
</div></blockquote>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>According to <a class="reference internal" href="#nw20010" id="id1">[NW20010]</a>, pages 75–76, a function
<img class="math" src="../_images/math/4d9e5a9c6310b693eb88a6caa627de0144d14787.png" alt="f : \mathbb{R}^2 \to \mathbb{R}"/> that has compact support</p>
<div class="math">
<p><img src="../_images/math/bf61b57bad8f01ff30f5aae9555724eed3eb6e00.png" alt="\| x \| &gt; \rho  \implies f(x) = 0,"/></p>
</div><p>and is essentially bandlimited</p>
<div class="math">
<p><img src="../_images/math/33642249542608eb6a400a7885f5daa8f8bfd9fa.png" alt="\| \xi \| &gt; \Omega \implies \hat{f}(\xi) \approx 0,"/></p>
</div><p>can be fully reconstructed from a fan beam ray transform with
source-detector distance <img class="math" src="../_images/math/eaa6ad49a7f78fe5a13b486690163bf2dc7e3e60.png" alt="r"/> (assuming all detector
points have the same distance to the source) if (1) the projection
angles are sampled with a spacing of <img class="math" src="../_images/math/c7b55a1556ec5759ac35d7d3dbeefc5f7ed3be8a.png" alt="\Delta \psi"/> such that</p>
<div class="math">
<p><img src="../_images/math/1bf21d52a0d24ae70b24f1c7890d7896456df3f7.png" alt="\Delta \psi \leq \frac{r + \rho}{r}\, \frac{\pi}{\rho \Omega},"/></p>
</div><p>and (2) the detector is sampled with an angular interval
<img class="math" src="../_images/math/171dd79d0ff120a8b2383370f87d3c1567b1f43f.png" alt="\Delta \alpha"/> that satisfies</p>
<div class="math">
<p><img src="../_images/math/6f7ddc18011c3f075b28f758da6503868aee0361.png" alt="\Delta \alpha \leq \frac{\pi}{r \Omega}."/></p>
</div><p>For a flat detector, the angular interval is smallest in the center
of the fan and largest at the boundaries. The worst-case relation
between the linear and angular sampling intervals are</p>
<div class="math">
<p><img src="../_images/math/ac5df5a60efa846d6cf8b7ce3547e2020f23e69e.png" alt="\Delta s = R \Delta \alpha, \quad R^2 = r^2 + (w / 2)^2,"/></p>
</div><p>where <img class="math" src="../_images/math/ecd1ee2a1cd226b40c37e079aca62398d4b774f5.png" alt="w"/> is the width of the detector.
Thus, to satisfy the angular detector condition one can choose</p>
<div class="math">
<p><img src="../_images/math/b8bde05fec92aaf4714f0eb0ab4e29d108efcf8c.png" alt="\Delta s \leq \frac{\pi \sqrt{r^2 + (w / 2)^2}}{r \Omega}."/></p>
</div><p>The geometry returned by this function satisfies these conditions exactly.</p>
<p>If the domain is 3-dimensional, a circular cone beam geometry is
created with the third coordinate axis as rotation axis. This does,
of course, not yield complete data, but is equivalent to the
2D fan beam case in the <img class="math" src="../_images/math/d632699d676810442d4fb2e2d7942f8c8190cb1a.png" alt="z = 0"/> slice. The vertical size of
the detector is chosen such that it covers the object vertically
with rays, using a containing cuboid
<img class="math" src="../_images/math/602c85bf83727c75a8f93ff9c5addda5367f225e.png" alt="[-\rho, \rho]^2 \times [z_{\mathrm{min}}, z_{\mathrm{min}}]"/>
to compute the cone angle.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="nw20010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[NW20010]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Natterer, F and Wuebbeling, F.
<em>Mathematical Methods in Image Reconstruction</em>.
SIAM, 2001.
<a class="reference external" href="https://dx.doi.org/10.1137/1.9780898718324">https://dx.doi.org/10.1137/1.9780898718324</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create a fan beam geometry from a 2d space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">space</span> <span class="o">=</span> <span class="n">odl</span><span class="o">.</span><span class="n">uniform_discr</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">cone_beam_geometry</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">src_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">det_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">angles</span><span class="o">.</span><span class="n">size</span>
<span class="go">78</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">size</span>
<span class="go">57</span>
</pre></div>
</div>
<p>For a short scan geometry (from 0 to <code class="docutils literal notranslate"><span class="pre">pi</span> <span class="pre">+</span> <span class="pre">fan_angle</span></code>), the
<code class="docutils literal notranslate"><span class="pre">short_scan</span></code> flag can be set, resulting in a smaller number of
angles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">cone_beam_geometry</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">src_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">det_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">short_scan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">angles</span><span class="o">.</span><span class="n">size</span>
<span class="go">46</span>
</pre></div>
</div>
<p>If the source is close to the object, the detector becomes larger due
to more magnification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">cone_beam_geometry</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">src_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">det_radius</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">angles</span><span class="o">.</span><span class="n">size</span>
<span class="go">80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">size</span>
<span class="go">105</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="odl.tomo.geometry.conebeam.helical_geometry.html" class="btn btn-neutral float-right" title="helical_geometry" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="odl.tomo.geometry.conebeam.FanFlatGeometry.src_position.html" class="btn btn-neutral" title="FanFlatGeometry.src_position" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, ODL development group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>